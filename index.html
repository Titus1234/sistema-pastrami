<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gesti√≥n Pastrami</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState } = React;

        function PastramiApp() {
          const [activeTab, setActiveTab] = useState('pedidos');
          const [showModal, setShowModal] = useState(false);
          const [modalType, setModalType] = useState('');
          const [editingItem, setEditingItem] = useState(null);
          
          const [clientes, setClientes] = useState([
            { id: 1, nombre: 'Juan', apellido: 'P√©rez', telefono: '11-1234-5678', calle: 'Av. Corrientes', numero: '1234', piso: '2A', codigoPostal: '1043', localidad: 'Buenos Aires', email: 'juan@email.com', fechaRegistro: '2025-01-15' },
            { id: 2, nombre: 'Mar√≠a', apellido: 'Gonz√°lez', telefono: '11-8765-4321', calle: 'San Mart√≠n', numero: '567', piso: '', codigoPostal: '1426', localidad: 'Buenos Aires', email: 'maria@email.com', fechaRegistro: '2025-02-10' },
            { id: 3, nombre: 'Carlos', apellido: 'L√≥pez', telefono: '11-9999-8888', calle: 'Rivadavia', numero: '890', piso: '1B', codigoPostal: '1205', localidad: 'Buenos Aires', email: 'carlos@email.com', fechaRegistro: '2025-03-01' }
          ]);
          
          const [productos, setProductos] = useState([
            { id: 'P001', nombre: 'Pastrami Cl√°sico', precio: 2500, stock: 20, tipo: 'simple', componentes: [{ item: 'Pastrami', cantidad: 200 }] },
            { id: 'P002', nombre: 'Caja Mixta', precio: 8000, stock: 3, tipo: 'compuesto', componentes: [{ item: 'Pastrami', cantidad: 300 }, { item: 'Pan', cantidad: 4 }] },
            { id: 'P003', nombre: 'Pastrami Premium', precio: 3500, stock: 15, tipo: 'simple', componentes: [{ item: 'Pastrami Premium', cantidad: 250 }] }
          ]);
          
          const [pedidos, setPedidos] = useState([
            { 
              id: 1, 
              cliente: clientes[0], 
              productos: [{ producto: productos[0], cantidad: 2, precio: 2500 }], 
              costoEnvio: 500, 
              total: 5500, 
              fechaEntrega: '2025-06-05', 
              fechaPedido: '2025-05-28',
              turno: 'ma√±ana',
              estado: 'pendiente',
              pagos: { total: 5500, pagado: 2000, saldo: 3500, formaPago: 'Mercado Pago' }
            },
            { 
              id: 2, 
              cliente: clientes[1], 
              productos: [{ producto: productos[1], cantidad: 1, precio: 8000 }], 
              costoEnvio: 800, 
              total: 8800, 
              fechaEntrega: '2025-06-06', 
              fechaPedido: '2025-05-30',
              turno: 'tarde',
              estado: 'completado',
              pagos: { total: 8800, pagado: 8800, saldo: 0, formaPago: 'Efectivo' }
            },
            { 
              id: 3, 
              cliente: clientes[0], 
              productos: [{ producto: productos[2], cantidad: 1, precio: 3500 }], 
              costoEnvio: 600, 
              total: 4100, 
              fechaEntrega: '2025-06-07', 
              fechaPedido: '2025-06-01',
              turno: 'ma√±ana',
              estado: 'pendiente',
              pagos: { total: 4100, pagado: 4100, saldo: 0, formaPago: 'Transferencia' }
            }
          ]);

          // Modal Component
          const Modal = ({ children, onClose }) => (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
              <div className="bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto">
                <button onClick={onClose} className="float-right text-gray-500 hover:text-gray-700 text-2xl font-bold">√ó</button>
                <div className="clear-both">
                  {children}
                </div>
              </div>
            </div>
          );

          // Formulario Cliente
          const FormularioCliente = () => {
            const [cliente, setCliente] = useState(editingItem || {
              nombre: '', apellido: '', telefono: '', calle: '', numero: '', 
              piso: '', codigoPostal: '', localidad: '', email: '', fechaRegistro: new Date().toISOString().split('T')[0]
            });

            const guardar = () => {
              if (!cliente.nombre || !cliente.apellido) {
                alert('Por favor completa nombre y apellido');
                return;
              }
              
              if (editingItem) {
                setClientes(clientes.map(c => c.id === editingItem.id ? { ...cliente, id: editingItem.id } : c));
              } else {
                setClientes([...clientes, { ...cliente, id: Date.now() }]);
              }
              setShowModal(false);
              setEditingItem(null);
            };

            return (
              <div>
                <h3 className="text-xl font-bold mb-4">{editingItem ? 'Editar Cliente' : 'Nuevo Cliente'}</h3>
                <div className="grid grid-cols-2 gap-4 mb-4">
                  <input placeholder="Nombre *" value={cliente.nombre} onChange={(e) => setCliente({...cliente, nombre: e.target.value})} className="p-3 border rounded" />
                  <input placeholder="Apellido *" value={cliente.apellido} onChange={(e) => setCliente({...cliente, apellido: e.target.value})} className="p-3 border rounded" />
                  <input placeholder="Tel√©fono" value={cliente.telefono} onChange={(e) => setCliente({...cliente, telefono: e.target.value})} className="p-3 border rounded" />
                  <input placeholder="Email" value={cliente.email} onChange={(e) => setCliente({...cliente, email: e.target.value})} className="p-3 border rounded" />
                  <input placeholder="Calle" value={cliente.calle} onChange={(e) => setCliente({...cliente, calle: e.target.value})} className="p-3 border rounded" />
                  <input placeholder="N√∫mero" value={cliente.numero} onChange={(e) => setCliente({...cliente, numero: e.target.value})} className="p-3 border rounded" />
                  <input placeholder="Piso/Depto" value={cliente.piso} onChange={(e) => setCliente({...cliente, piso: e.target.value})} className="p-3 border rounded" />
                  <input placeholder="C√≥digo Postal" value={cliente.codigoPostal} onChange={(e) => setCliente({...cliente, codigoPostal: e.target.value})} className="p-3 border rounded" />
                  <input placeholder="Localidad" value={cliente.localidad} onChange={(e) => setCliente({...cliente, localidad: e.target.value})} className="p-3 border rounded col-span-2" />
                </div>
                <div className="flex gap-3">
                  <button onClick={guardar} className="bg-green-500 text-white px-6 py-2 rounded hover:bg-green-600">
                    {editingItem ? 'Actualizar' : 'Guardar'}
                  </button>
                  <button onClick={() => { setShowModal(false); setEditingItem(null); }} className="bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600">
                    Cancelar
                  </button>
                </div>
              </div>
            );
          };

          // Formulario Producto
          const FormularioProducto = () => {
            const [producto, setProducto] = useState(editingItem || {
              id: '', nombre: '', precio: '', stock: '', tipo: 'simple', componentes: [{ item: '', cantidad: '' }]
            });

            const agregarComponente = () => {
              setProducto({ 
                ...producto, 
                componentes: [...producto.componentes, { item: '', cantidad: '' }] 
              });
            };

            const eliminarComponente = (index) => {
              if (producto.componentes.length > 1) {
                const nuevosComponentes = producto.componentes.filter((_, i) => i !== index);
                setProducto({ ...producto, componentes: nuevosComponentes });
              }
            };

            const actualizarComponente = (index, campo, valor) => {
              const nuevosComponentes = [...producto.componentes];
              nuevosComponentes[index][campo] = valor;
              setProducto({ ...producto, componentes: nuevosComponentes });
            };

            const guardar = () => {
              if (!producto.id || !producto.nombre || !producto.precio) {
                alert('Por favor completa ID, nombre y precio');
                return;
              }

              const productoFinal = {
                ...producto,
                precio: parseFloat(producto.precio),
                stock: parseInt(producto.stock) || 0,
                componentes: producto.componentes.filter(c => c.item && c.cantidad)
              };

              if (editingItem) {
                setProductos(productos.map(p => p.id === editingItem.id ? productoFinal : p));
              } else {
                setProductos([...productos, productoFinal]);
              }
              setShowModal(false);
              setEditingItem(null);
            };

            return (
              <div>
                <h3 className="text-xl font-bold mb-4">{editingItem ? 'Editar Producto' : 'Nuevo Producto'}</h3>
                
                <div className="grid grid-cols-2 gap-4 mb-4">
                  <input placeholder="ID del Producto *" value={producto.id} onChange={(e) => setProducto({...producto, id: e.target.value})} className="p-3 border rounded" />
                  <input placeholder="Nombre del Producto *" value={producto.nombre} onChange={(e) => setProducto({...producto, nombre: e.target.value})} className="p-3 border rounded" />
                  <input placeholder="Precio *" type="number" value={producto.precio} onChange={(e) => setProducto({...producto, precio: e.target.value})} className="p-3 border rounded" />
                  <input placeholder="Stock" type="number" value={producto.stock} onChange={(e) => setProducto({...producto, stock: e.target.value})} className="p-3 border rounded" />
                  <div className="col-span-2">
                    <select value={producto.tipo} onChange={(e) => setProducto({...producto, tipo: e.target.value})} className="w-full p-3 border rounded">
                      <option value="simple">Simple</option>
                      <option value="compuesto">Compuesto</option>
                    </select>
                  </div>
                </div>

                <div className="mb-6">
                  <h4 className="text-lg font-semibold mb-3">Componentes:</h4>
                  {producto.componentes.map((comp, index) => (
                    <div key={index} className="grid grid-cols-5 gap-3 mb-3">
                      <input placeholder="Componente" value={comp.item} onChange={(e) => actualizarComponente(index, 'item', e.target.value)} className="col-span-2 p-2 border rounded" />
                      <input placeholder="Cantidad" type="number" value={comp.cantidad} onChange={(e) => actualizarComponente(index, 'cantidad', e.target.value)} className="col-span-2 p-2 border rounded" />
                      <div className="flex gap-1">
                        <button onClick={agregarComponente} className="bg-green-500 text-white p-2 rounded hover:bg-green-600 flex-1">+</button>
                        {producto.componentes.length > 1 && (
                          <button onClick={() => eliminarComponente(index)} className="bg-red-500 text-white p-2 rounded hover:bg-red-600 flex-1">-</button>
                        )}
                      </div>
                    </div>
                  ))}
                </div>
                
                <div className="flex gap-3">
                  <button onClick={guardar} className="bg-green-500 text-white px-6 py-2 rounded hover:bg-green-600">
                    {editingItem ? 'Actualizar' : 'Guardar'}
                  </button>
                  <button onClick={() => { setShowModal(false); setEditingItem(null); }} className="bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600">
                    Cancelar
                  </button>
                </div>
              </div>
            );
          };

          // Formulario Pedido
          const FormularioPedido = () => {
            const [pedido, setPedido] = useState(editingItem || {
              cliente: null, productos: [], costoEnvio: 0, fechaEntrega: '', fechaPedido: new Date().toISOString().split('T')[0], turno: 'ma√±ana', pagos: { formaPago: 'Efectivo', pagado: 0 }
            });
            
            const [busquedaCliente, setBusquedaCliente] = useState(editingItem ? `${editingItem.cliente.nombre} ${editingItem.cliente.apellido}` : '');
            const [clientesEncontrados, setClientesEncontrados] = useState([]);

            const buscarClientes = (termino) => {
              setBusquedaCliente(termino);
              if (termino.length > 0) {
                const encontrados = clientes.filter(c => 
                  c.nombre.toLowerCase().includes(termino.toLowerCase()) ||
                  c.apellido.toLowerCase().includes(termino.toLowerCase())
                );
                setClientesEncontrados(encontrados);
              } else {
                setClientesEncontrados([]);
              }
            };

            const seleccionarCliente = (cliente) => {
              setPedido({...pedido, cliente});
              setBusquedaCliente(`${cliente.nombre} ${cliente.apellido}`);
              setClientesEncontrados([]);
            };

            const agregarProducto = () => {
              setPedido({ ...pedido, productos: [...pedido.productos, { producto: null, cantidad: 1, precio: 0 }] });
            };

            const eliminarProducto = (index) => {
              const nuevosProductos = pedido.productos.filter((_, i) => i !== index);
              setPedido({...pedido, productos: nuevosProductos});
            };

            const actualizarProducto = (index, campo, valor) => {
              const nuevosProductos = [...pedido.productos];
              if (campo === 'producto') {
                const productoSeleccionado = productos.find(p => p.id === valor);
                nuevosProductos[index] = { ...nuevosProductos[index], producto: productoSeleccionado, precio: productoSeleccionado?.precio || 0 };
              } else {
                nuevosProductos[index][campo] = valor;
              }
              setPedido({...pedido, productos: nuevosProductos});
            };

            const calcularTotal = () => {
              const subtotal = pedido.productos.reduce((sum, item) => sum + (item.precio * item.cantidad), 0);
              return subtotal + pedido.costoEnvio;
            };

            const guardar = () => {
              if (!pedido.cliente) {
                alert('Por favor selecciona un cliente');
                return;
              }
              if (pedido.productos.length === 0) {
                alert('Por favor agrega al menos un producto');
                return;
              }

              const pedidoFinal = {
                ...pedido,
                total: calcularTotal(),
                estado: 'pendiente',
                pagos: { ...pedido.pagos, total: calcularTotal(), saldo: calcularTotal() - pedido.pagos.pagado }
              };

              if (editingItem) {
                setPedidos(pedidos.map(p => p.id === editingItem.id ? { ...pedidoFinal, id: editingItem.id } : p));
              } else {
                setPedidos([...pedidos, { ...pedidoFinal, id: Date.now() }]);
              }
              setShowModal(false);
              setEditingItem(null);
            };

            return (
              <div>
                <h3 className="text-xl font-bold mb-4">{editingItem ? 'Editar Pedido' : 'Nuevo Pedido'}</h3>
                
                <div className="mb-4">
                  <label className="block text-sm font-semibold mb-2">Buscar Cliente:</label>
                  <input placeholder="Escribe nombre o apellido..." value={busquedaCliente} onChange={(e) => buscarClientes(e.target.value)} className="w-full p-3 border rounded" />
                  {clientesEncontrados.length > 0 && (
                    <div className="border rounded mt-2 max-h-32 overflow-y-auto bg-white shadow">
                      {clientesEncontrados.map(cliente => (
                        <div key={cliente.id} className="p-3 hover:bg-blue-50 cursor-pointer" onClick={() => seleccionarCliente(cliente)}>
                          <div className="font-semibold">{cliente.nombre} {cliente.apellido}</div>
                          <div className="text-sm text-gray-600">{cliente.telefono}</div>
                        </div>
                      ))}
                    </div>
                  )}
                  {pedido.cliente && (
                    <div className="mt-2 p-3 bg-green-50 rounded border border-green-200">
                      <strong>Cliente:</strong> {pedido.cliente.nombre} {pedido.cliente.apellido}
                    </div>
                  )}
                </div>

                <div className="mb-4">
                  <label className="block text-sm font-semibold mb-2">Productos:</label>
                  {pedido.productos.map((item, index) => (
                    <div key={index} className="grid grid-cols-5 gap-3 mb-3 p-3 bg-gray-50 rounded">
                      <select value={item.producto?.id || ''} onChange={(e) => actualizarProducto(index, 'producto', e.target.value)} className="p-2 border rounded">
                        <option value="">Seleccionar</option>
                        {productos.map(prod => (
                          <option key={prod.id} value={prod.id}>{prod.nombre} - ${prod.precio}</option>
                        ))}
                      </select>
                      <input type="number" placeholder="Cantidad" value={item.cantidad} onChange={(e) => actualizarProducto(index, 'cantidad', parseInt(e.target.value) || 1)} className="p-2 border rounded" min="1" />
                      <input type="number" placeholder="Precio" value={item.precio} onChange={(e) => actualizarProducto(index, 'precio', parseFloat(e.target.value) || 0)} className="p-2 border rounded" />
                      <div className="text-center p-2 font-semibold">${(item.precio * item.cantidad) || 0}</div>
                      <button onClick={() => eliminarProducto(index)} className="bg-red-500 text-white p-2 rounded hover:bg-red-600">üóëÔ∏è</button>
                    </div>
                  ))}
                  <button onClick={agregarProducto} className="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">+ Agregar Producto</button>
                </div>

                <div className="grid grid-cols-2 gap-4 mb-4">
                  <div>
                    <label className="block text-sm font-semibold mb-2">Costo Env√≠o:</label>
                    <input type="number" value={pedido.costoEnvio} onChange={(e) => setPedido({...pedido, costoEnvio: parseFloat(e.target.value) || 0})} className="w-full p-3 border rounded" />
                  </div>
                  <div>
                    <label className="block text-sm font-semibold mb-2">Fecha Entrega:</label>
                    <input type="date" value={pedido.fechaEntrega} onChange={(e) => setPedido({...pedido, fechaEntrega: e.target.value})} className="w-full p-3 border rounded" />
                  </div>
                  <div>
                    <label className="block text-sm font-semibold mb-2">Turno:</label>
                    <select value={pedido.turno} onChange={(e) => setPedido({...pedido, turno: e.target.value})} className="w-full p-3 border rounded">
                      <option value="ma√±ana">Ma√±ana</option>
                      <option value="tarde">Tarde</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-semibold mb-2">Forma de Pago:</label>
                    <select value={pedido.pagos.formaPago} onChange={(e) => setPedido({...pedido, pagos: {...pedido.pagos, formaPago: e.target.value}})} className="w-full p-3 border rounded">
                      <option value="Efectivo">Efectivo</option>
                      <option value="Mercado Pago">Mercado Pago</option>
                      <option value="Transferencia">Transferencia</option>
                    </select>
                  </div>
                  <div className="col-span-2">
                    <label className="block text-sm font-semibold mb-2">Monto Pagado:</label>
                    <input type="number" value={pedido.pagos.pagado} onChange={(e) => setPedido({...pedido, pagos: {...pedido.pagos, pagado: parseFloat(e.target.value) || 0}})} className="w-full p-3 border rounded" />
                  </div>
                </div>

                <div className="bg-blue-50 p-4 rounded mb-4">
                  <div className="text-lg font-bold">Total: ${calcularTotal()}</div>
                  <div className="text-sm">Saldo: ${calcularTotal() - pedido.pagos.pagado}</div>
                </div>
                
                <div className="flex gap-3">
                  <button onClick={guardar} className="bg-green-500 text-white px-6 py-2 rounded hover:bg-green-600">
                    {editingItem ? 'Actualizar' : 'Guardar'}
                  </button>
                  <button onClick={() => { setShowModal(false); setEditingItem(null); }} className="bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600">
                    Cancelar
                  </button>
                </div>
              </div>
            );
          };

          // Estad√≠sticas calculadas
          const calcularEstadisticas = () => {
            // 1. Art√≠culo m√°s vendido
            const ventasPorProducto = {};
            pedidos.forEach(pedido => {
              pedido.productos.forEach(item => {
                const nombre = item.producto.nombre;
                ventasPorProducto[nombre] = (ventasPorProducto[nombre] || 0) + item.cantidad;
              });
            });
            const articuloMasVendido = Object.entries(ventasPorProducto).sort((a, b) => b[1] - a[1])[0];

            // 2. Por c√≥digo postal
            const ventasPorCP = {};
            pedidos.forEach(pedido => {
              const cp = pedido.cliente.codigoPostal;
              ventasPorCP[cp] = (ventasPorCP[cp] || 0) + 1;
            });

            // 3. Cliente que m√°s pedidos hace
            const pedidosPorCliente = {};
            pedidos.forEach(pedido => {
              const clienteNombre = `${pedido.cliente.nombre} ${pedido.cliente.apellido}`;
              pedidosPorCliente[clienteNombre] = (pedidosPorCliente[clienteNombre] || 0) + 1;
            });
            const clienteMasPedidos = Object.entries(pedidosPorCliente).sort((a, b) => b[1] - a[1])[0];

            // 4. Clientes que compraron m√°s de una vez
            const clientesRepetidos = Object.entries(pedidosPorCliente).filter(([_, cantidad]) => cantidad > 1);

            // 5. Clientes nuevos (√∫ltimos 30 d√≠as)
            const fechaLimite = new Date();
            fechaLimite.setDate(fechaLimite.getDate() - 30);
            const clientesNuevos = clientes.filter(cliente => new Date(cliente.fechaRegistro) >= fechaLimite);

            // 6. Por forma de pago
            const ventasPorPago = {};
            pedidos.forEach(pedido => {
              const forma = pedido.pagos.formaPago;
              ventasPorPago[forma] = (ventasPorPago[forma] || 0) + 1;
            });

            return {
              articuloMasVendido,
              ventasPorCP,
              clienteMasPedidos,
              clientesRepetidos,
              clientesNuevos,
              ventasPorPago
            };
          };

          const stats = calcularEstadisticas();

          return (
            <div className="min-h-screen bg-gray-100">
              {/* Header */}
              <div className="bg-blue-600 text-white p-6">
                <h1 className="text-3xl font-bold">ü•™ Sistema de Gesti√≥n Pastrami</h1>
                <p className="text-blue-200">Gesti√≥n completa de tu emprendimiento</p>
              </div>

              {/* Navigation - BOTONES M√ÅS GRANDES */}
              <div className="bg-white border-b">
                <div className="flex">
                  <button 
                    onClick={() => setActiveTab('pedidos')} 
                    className={`px-8 py-6 text-lg font-semibold border-b-2 ${activeTab === 'pedidos' ? 'border-blue-500 text-blue-600 bg-blue-50' : 'border-transparent text-gray-600 hover:text-gray-800'}`}
                  >
                    üìã Pedidos
                  </button>
                  <button 
                    onClick={() => setActiveTab('clientes')} 
                    className={`px-8 py-6 text-lg font-semibold border-b-2 ${activeTab === 'clientes' ? 'border-blue-500 text-blue-600 bg-blue-50' : 'border-transparent text-gray-600 hover:text-gray-800'}`}
                  >
                    üë• Clientes
                  </button>
                  <button 
                    onClick={() => setActiveTab('productos')} 
                    className={`px-8 py-6 text-lg font-semibold border-b-2 ${activeTab === 'productos' ? 'border-blue-500 text-blue-600 bg-blue-50' : 'border-transparent text-gray-600 hover:text-gray-800'}`}
                  >
                    üì¶ Productos
                  </button>
                  <button 
                    onClick={() => setActiveTab('envios')} 
                    className={`px-8 py-6 text-lg font-semibold border-b-2 ${activeTab === 'envios' ? 'border-blue-500 text-blue-600 bg-blue-50' : 'border-transparent text-gray-600 hover:text-gray-800'}`}
                  >
                    üöö Env√≠os
                  </button>
                  <button 
                    onClick={() => setActiveTab('estadisticas')} 
                    className={`px-8 py-6 text-lg font-semibold border-b-2 ${activeTab === 'estadisticas' ? 'border-blue-500 text-blue-600 bg-blue-50' : 'border-transparent text-gray-600 hover:text-gray-800'}`}
                  >
                    üìä Estad√≠sticas
                  </button>
                </div>
              </div>

              {/* Content */}
              <div className="p-6">
                {activeTab === 'pedidos' && (
                  <div>
                    <button 
                      onClick={() => { setModalType('pedido'); setEditingItem(null); setShowModal(true); }} 
                      className="bg-orange-500 text-white px-6 py-3 rounded-lg mb-6 hover:bg-orange-600 text-lg font-semibold"
                    >
                      ‚ûï Nuevo Pedido
                    </button>
                    
                    <div className="space-y-6">
                      {pedidos.map(pedido => (
                        <div key={pedido.id} className="bg-white p-6 rounded-lg shadow border-l-4 border-orange-500">
                          <div className="mb-4">
                            <h3 className="font-bold text-xl text-gray-800">üßæ Pedido #{pedido.id} - {pedido.cliente.nombre} {pedido.cliente.apellido}</h3>
                            <p className="text-gray-600">üìû {pedido.cliente.telefono}</p>
                            <p className="text-gray-600">üìç {pedido.cliente.calle} {pedido.cliente.numero}, {pedido.cliente.localidad}</p>
                          </div>
                          
                          <div className="grid grid-cols-2 lg:grid-cols-5 gap-4 mb-4">
                            <div className="bg-green-50 p-3 rounded border border-green-200">
                              <p className="text-green-600 font-semibold text-sm">Total</p>
                              <p className="font-bold text-lg text-green-800">${pedido.total}</p>
                            </div>
                            <div className="bg-orange-50 p-3 rounded border border-orange-200">
                              <p className="text-orange-600 font-semibold text-sm">üöö Env√≠o</p>
                              <p className="font-bold text-lg text-orange-800">${pedido.costoEnvio}</p>
                            </div>
                            <div className="bg-blue-50 p-3 rounded border border-blue-200">
                              <p className="text-blue-600 font-semibold text-sm">üìÖ Entrega</p>
                              <p className="font-bold text-blue-800">{pedido.fechaEntrega}</p>
                            </div>
                            <div className="bg-purple-50 p-3 rounded border border-purple-200">
                              <p className="text-purple-600 font-semibold text-sm">üí∞ Pagado</p>
                              <p className="font-bold text-purple-800">${pedido.pagos.pagado}</p>
                            </div>
                            <div className="bg-yellow-50 p-3 rounded border border-yellow-200">
                              <p className="text-yellow-600 font-semibold text-sm">Estado</p>
                              <span className="px-2 py-1 rounded-full text-xs font-semibold bg-yellow-200 text-yellow-800">{pedido.estado}</span>
                            </div>
                          </div>
                          
                          <div className="flex gap-3 pt-4 border-t">
                            <button 
                              onClick={() => { setEditingItem(pedido); setModalType('pedido'); setShowModal(true); }} 
                              className="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"
                            >
                              ‚úèÔ∏è Editar
                            </button>
                            <button 
                              onClick={() => { 
                                if (confirm(`¬øEliminar Pedido #${pedido.id}?`)) { 
                                  setPedidos(pedidos.filter(p => p.id !== pedido.id)); 
                                } 
                              }} 
                              className="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"
                            >
                              üóëÔ∏è Eliminar
                            </button>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                )}

                {activeTab === 'clientes' && (
                  <div>
                    <div className="flex justify-between items-center mb-6">
                      <h2 className="text-2xl font-bold">üë• Lista de Clientes</h2>
                      <button 
                        onClick={() => { setModalType('cliente'); setEditingItem(null); setShowModal(true); }} 
                        className="bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 text-lg font-semibold"
                      >
                        ‚ûï Nuevo Cliente
                      </button>
                    </div>
                    
                    <div className="bg-white rounded-lg shadow overflow-hidden">
                      <table className="w-full">
                        <thead className="bg-gray-50">
                          <tr>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cliente</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tel√©fono</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Direcci√≥n</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acciones</th>
                          </tr>
                        </thead>
                        <tbody className="bg-white divide-y divide-gray-200">
                          {clientes
                            .sort((a, b) => `${a.apellido} ${a.nombre}`.localeCompare(`${b.apellido} ${b.nombre}`))
                            .map(cliente => (
                            <tr key={cliente.id} className="hover:bg-gray-50">
                              <td className="px-6 py-4 whitespace-nowrap">
                                <div className="font-semibold text-gray-900">{cliente.apellido}, {cliente.nombre}</div>
                              </td>
                              <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                {cliente.telefono}
                              </td>
                              <td className="px-6 py-4 text-sm text-gray-500">
                                {cliente.calle} {cliente.numero} {cliente.piso && `, ${cliente.piso}`}<br/>
                                {cliente.localidad} ({cliente.codigoPostal})
                              </td>
                              <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                {cliente.email}
                              </td>
                              <td className="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                <div className="flex gap-2">
                                  <button 
                                    onClick={() => { setEditingItem(cliente); setModalType('cliente'); setShowModal(true); }} 
                                    className="bg-blue-500 text-white px-3 py-1 rounded text-xs hover:bg-blue-600"
                                  >
                                    ‚úèÔ∏è Editar
                                  </button>
                                  <button 
                                    onClick={() => { 
                                      if (confirm(`¬øEliminar cliente ${cliente.nombre} ${cliente.apellido}?`)) { 
                                        setClientes(prevClientes => prevClientes.filter(c => c.id !== cliente.id)); 
                                        alert('Cliente eliminado correctamente');
                                      } 
                                    }} 
                                    className="bg-red-500 text-white px-3 py-1 rounded text-xs hover:bg-red-600"
                                  >
                                    üóëÔ∏è Eliminar
                                  </button>
                                </div>
                              </td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                      
                      {clientes.length === 0 && (
                        <div className="text-center py-8 text-gray-500">
                          No hay clientes registrados
                        </div>
                      )}
                    </div>
                  </div>
                )}

                {activeTab === 'productos' && (
                  <div>
                    <div className="flex justify-between items-center mb-6">
                      <h2 className="text-2xl font-bold">üì¶ Lista de Productos</h2>
                      <button 
                        onClick={() => { setModalType('producto'); setEditingItem(null); setShowModal(true); }} 
                        className="bg-purple-500 text-white px-6 py-3 rounded-lg hover:bg-purple-600 text-lg font-semibold"
                      >
                        ‚ûï Nuevo Producto
                      </button>
                    </div>
                    
                    <div className="bg-white rounded-lg shadow overflow-hidden">
                      <table className="w-full">
                        <thead className="bg-gray-50">
                          <tr>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Producto</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Precio</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stock</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tipo</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Componentes</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acciones</th>
                          </tr>
                        </thead>
                        <tbody className="bg-white divide-y divide-gray-200">
                          {productos
                            .sort((a, b) => a.nombre.localeCompare(b.nombre))
                            .map(producto => (
                            <tr key={producto.id} className="hover:bg-gray-50">
                              <td className="px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-900">
                                {producto.id}
                              </td>
                              <td className="px-6 py-4 whitespace-nowrap">
                                <div className="font-semibold text-gray-900">{producto.nombre}</div>
                              </td>
                              <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-semibold">
                                ${producto.precio}
                              </td>
                              <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                <span className={`px-2 py-1 rounded-full text-xs font-semibold ${
                                  producto.stock < 5 ? 'bg-red-100 text-red-800' : 
                                  producto.stock < 10 ? 'bg-yellow-100 text-yellow-800' : 
                                  'bg-green-100 text-green-800'
                                }`}>
                                  {producto.stock} unidades
                                </span>
                              </td>
                              <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                <span className={`px-2 py-1 rounded-full text-xs font-semibold ${
                                  producto.tipo === 'simple' ? 'bg-blue-100 text-blue-800' : 'bg-purple-100 text-purple-800'
                                }`}>
                                  {producto.tipo === 'simple' ? 'Simple' : 'Compuesto'}
                                </span>
                              </td>
                              <td className="px-6 py-4 text-sm text-gray-500">
                                <div className="space-y-1">
                                  {producto.componentes.map((comp, idx) => (
                                    <div key={idx} className="text-xs">
                                      ‚Ä¢ {comp.item}: {comp.cantidad}
                                    </div>
                                  ))}
                                </div>
                              </td>
                              <td className="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                <div className="flex gap-2">
                                  <button 
                                    onClick={() => { setEditingItem(producto); setModalType('producto'); setShowModal(true); }} 
                                    className="bg-blue-500 text-white px-3 py-1 rounded text-xs hover:bg-blue-600"
                                  >
                                    ‚úèÔ∏è Editar
                                  </button>
                                  <button 
                                    onClick={() => { 
                                      if (confirm(`¬øEliminar producto ${producto.nombre}?`)) { 
                                        setProductos(prevProductos => prevProductos.filter(p => p.id !== producto.id)); 
                                        alert('Producto eliminado correctamente');
                                      } 
                                    }} 
                                    className="bg-red-500 text-white px-3 py-1 rounded text-xs hover:bg-red-600"
                                  >
                                    üóëÔ∏è Eliminar
                                  </button>
                                </div>
                              </td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                      
                      {productos.length === 0 && (
                        <div className="text-center py-8 text-gray-500">
                          No hay productos registrados
                        </div>
                      )}
                    </div>
                  </div>
                )}

                {activeTab === 'envios' && (
                  <div>
                    <h2 className="text-2xl font-bold mb-6">üöö Pedidos Pendientes de Entrega</h2>
                    
                    <div className="bg-white rounded-lg shadow overflow-hidden">
                      <table className="w-full">
                        <thead className="bg-gray-50">
                          <tr>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Pedido #</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cliente</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Direcci√≥n de Entrega</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fecha Entrega</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Turno</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Estado Pago</th>
                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acciones</th>
                          </tr>
                        </thead>
                        <tbody className="bg-white divide-y divide-gray-200">
                          {pedidos
                            .filter(pedido => pedido.estado === 'pendiente')
                            .sort((a, b) => new Date(a.fechaEntrega) - new Date(b.fechaEntrega))
                            .map(pedido => (
                            <tr key={pedido.id} className="hover:bg-gray-50">
                              <td className="px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900">
                                #{pedido.id}
                              </td>
                              <td className="px-6 py-4 whitespace-nowrap">
                                <div className="font-semibold text-gray-900">{pedido.cliente.apellido}, {pedido.cliente.nombre}</div>
                                <div className="text-sm text-gray-500">üìû {pedido.cliente.telefono}</div>
                              </td>
                              <td className="px-6 py-4 text-sm text-gray-500">
                                üìç {pedido.cliente.calle} {pedido.cliente.numero} {pedido.cliente.piso && `, ${pedido.cliente.piso}`}<br/>
                                {pedido.cliente.localidad} ({pedido.cliente.codigoPostal})
                              </td>
                              <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                <div className="font-semibold">{pedido.fechaEntrega}</div>
                              </td>
                              <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                <span className={`px-2 py-1 rounded-full text-xs font-semibold ${
                                  pedido.turno === 'ma√±ana' ? 'bg-yellow-100 text-yellow-800' : 'bg-orange-100 text-orange-800'
                                }`}>
                                  {pedido.turno === 'ma√±ana' ? 'üåÖ Ma√±ana' : 'üåÜ Tarde'}
                                </span>
                              </td>
                              <td className="px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900">
                                ${pedido.total}
                              </td>
                              <td className="px-6 py-4 whitespace-nowrap">
                                {pedido.pagos.saldo === 0 ? (
                                  <span className="px-2 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800">
                                    ‚úÖ PAGADO
                                  </span>
                                ) : (
                                  <div>
                                    <span className="px-2 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-800">
                                      ‚ö†Ô∏è DEBE ${pedido.pagos.saldo}
                                    </span>
                                    <div className="text-xs text-gray-500 mt-1">
                                      Pag√≥: ${pedido.pagos.pagado}
                                    </div>
                                  </div>
                                )}
                              </td>
                              <td className="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                <div className="flex gap-2">
                                  <button 
                                    onClick={() => { 
                                      if (confirm(`¬øMarcar pedido #${pedido.id} como entregado?`)) { 
                                        setPedidos(prevPedidos => 
                                          prevPedidos.map(p => 
                                            p.id === pedido.id ? { ...p, estado: 'completado' } : p
                                          )
                                        ); 
                                        alert('Pedido marcado como entregado');
                                      } 
                                    }} 
                                    className="bg-green-500 text-white px-3 py-1 rounded text-xs hover:bg-green-600"
                                  >
                                    ‚úÖ Entregado
                                  </button>
                                  <button 
                                    onClick={() => { setEditingItem(pedido); setModalType('pedido'); setShowModal(true); }} 
                                    className="bg-blue-500 text-white px-3 py-1 rounded text-xs hover:bg-blue-600"
                                  >
                                    ‚úèÔ∏è Editar
                                  </button>
                                </div>
                              </td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                      
                      {pedidos.filter(p => p.estado === 'pendiente').length === 0 && (
                        <div className="text-center py-8 text-gray-500">
                          üéâ ¬°No hay pedidos pendientes de entrega!
                        </div>
                      )}
                    </div>

                    <div className="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                      <div className="bg-orange-50 p-4 rounded-lg border border-orange-200">
                        <h3 className="font-semibold text-orange-800">üì¶ Pedidos Pendientes</h3>
                        <p className="text-2xl font-bold text-orange-600">
                          {pedidos.filter(p => p.estado === 'pendiente').length}
                        </p>
                      </div>
                      
                      <div className="bg-red-50 p-4 rounded-lg border border-red-200">
                        <h3 className="font-semibold text-red-800">üí∞ Total por Cobrar</h3>
                        <p className="text-2xl font-bold text-red-600">
                          ${pedidos
                            .filter(p => p.estado === 'pendiente')
                            .reduce((sum, p) => sum + p.pagos.saldo, 0)
                          }
                        </p>
                      </div>
                      
                      <div className="bg-green-50 p-4 rounded-lg border border-green-200">
                        <h3 className="font-semibold text-green-800">‚úÖ Entregas Hoy</h3>
                        <p className="text-2xl font-bold text-green-600">
                          {pedidos
                            .filter(p => p.estado === 'pendiente' && p.fechaEntrega === new Date().toISOString().split('T')[0])
                            .length
                          }
                        </p>
                      </div>
                    </div>
                  </div>
                )}

                {activeTab === 'estadisticas' && (
                  <div>
                    <h2 className="text-2xl font-bold mb-6">üìä Estad√≠sticas del Negocio</h2>
                    
                    <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                      <div className="bg-white p-6 rounded-lg shadow border-l-4 border-green-500">
                        <h3 className="font-bold text-lg text-green-800">üí∞ Ingresos Totales</h3>
                        <p className="text-3xl font-bold text-green-600">
                          ${pedidos.reduce((sum, p) => sum + p.total, 0)}
                        </p>
                      </div>
                      
                      <div className="bg-white p-6 rounded-lg shadow border-l-4 border-blue-500">
                        <h3 className="font-bold text-lg text-blue-800">üìã Total Pedidos</h3>
                        <p className="text-3xl font-bold text-blue-600">{pedidos.length}</p>
                      </div>
                      
                      <div className="bg-white p-6 rounded-lg shadow border-l-4 border-orange-500">
                        <h3 className="font-bold text-lg text-orange-800">üë• Total Clientes</h3>
                        <p className="text-3xl font-bold text-orange-600">{clientes.length}</p>
                      </div>

                      <div className="bg-white p-6 rounded-lg shadow border-l-4 border-red-500">
                        <h3 className="font-bold text-lg text-red-800">üí∏ Saldo Pendiente</h3>
                        <p className="text-3xl font-bold text-red-600">
                          ${pedidos.reduce((sum, p) => sum + p.pagos.saldo, 0)}
                        </p>
                      </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                      <div className="bg-white p-6 rounded-lg shadow">
                        <h3 className="font-bold text-lg mb-4">üèÜ Art√≠culo M√°s Vendido</h3>
                        {stats.articuloMasVendido ? (
                          <div>
                            <p className="text-xl font-semibold">{stats.articuloMasVendido[0]}</p>
                            <p className="text-gray-600">{stats.articuloMasVendido[1]} unidades vendidas</p>
                          </div>
                        ) : (
                          <p className="text-gray-500">Sin datos</p>
                        )}
                      </div>

                      <div className="bg-white p-6 rounded-lg shadow">
                        <h3 className="font-bold text-lg mb-4">üìç Ventas por C√≥digo Postal</h3>
                        <div className="space-y-2">
                          {Object.entries(stats.ventasPorCP).map(([cp, cantidad]) => (
                            <div key={cp} className="flex justify-between">
                              <span>CP {cp}</span>
                              <span className="font-semibold">{cantidad} pedidos</span>
                            </div>
                          ))}
                        </div>
                      </div>

                      <div className="bg-white p-6 rounded-lg shadow">
                        <h3 className="font-bold text-lg mb-4">üåü Cliente M√°s Activo</h3>
                        {stats.clienteMasPedidos ? (
                          <div>
                            <p className="text-xl font-semibold">{stats.clienteMasPedidos[0]}</p>
                            <p className="text-gray-600">{stats.clienteMasPedidos[1]} pedidos realizados</p>
                          </div>
                        ) : (
                          <p className="text-gray-500">Sin datos</p>
                        )}
                      </div>

                      <div className="bg-white p-6 rounded-lg shadow">
                        <h3 className="font-bold text-lg mb-4">üîÑ Clientes Recurrentes</h3>
                        <div className="space-y-2">
                          {stats.clientesRepetidos.length > 0 ? (
                            stats.clientesRepetidos.map(([cliente, cantidad]) => (
                              <div key={cliente} className="flex justify-between">
                                <span>{cliente}</span>
                                <span className="font-semibold">{cantidad} compras</span>
                              </div>
                            ))
                          ) : (
                            <p className="text-gray-500">No hay clientes recurrentes</p>
                          )}
                        </div>
                      </div>

                      <div className="bg-white p-6 rounded-lg shadow">
                        <h3 className="font-bold text-lg mb-4">üÜï Clientes Nuevos (√∫ltimos 30 d√≠as)</h3>
                        <div className="space-y-2">
                          {stats.clientesNuevos.length > 0 ? (
                            stats.clientesNuevos.map(cliente => (
                              <div key={cliente.id} className="flex justify-between">
                                <span>{cliente.nombre} {cliente.apellido}</span>
                                <span className="text-sm text-gray-600">{cliente.fechaRegistro}</span>
                              </div>
                            ))
                          ) : (
                            <p className="text-gray-500">No hay clientes nuevos</p>
                          )}
                        </div>
                      </div>

                      <div className="bg-white p-6 rounded-lg shadow">
                        <h3 className="font-bold text-lg mb-4">üí≥ Ventas por Forma de Pago</h3>
                        <div className="space-y-2">
                          {Object.entries(stats.ventasPorPago).map(([forma, cantidad]) => (
                            <div key={forma} className="flex justify-between">
                              <span>{forma}</span>
                              <span className="font-semibold">{cantidad} pedidos</span>
                            </div>
                          ))}
                        </div>
                      </div>
                    </div>
                  </div>
                )}
              </div>

              {/* Modal */}
              {showModal && (
                <Modal onClose={() => { setShowModal(false); setEditingItem(null); }}>
                  {modalType === 'cliente' && <FormularioCliente />}
                  {modalType === 'producto' && <FormularioProducto />}
                  {modalType === 'pedido' && <FormularioPedido />}
                </Modal>
              )}
            </div>
          );
        }

        ReactDOM.render(<PastramiApp />, document.getElementById('root'));
    </script>
</body>
</html>
