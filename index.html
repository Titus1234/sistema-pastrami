<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Pastrami</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .header {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 10px 10px 0 0;
        }
        .tabs {
            display: flex;
            background: #f8f9fa;
        }
        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            background: #e9ecef;
            border: none;
            font-weight: bold;
        }
        .tab.active {
            background: white;
            color: #ff6b6b;
        }
        .tab-content {
            display: none;
            padding: 20px;
        }
        .tab-content.active {
            display: block;
        }
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        .form-col {
            flex: 1;
            min-width: 200px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
        }
        .btn {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        .btn-primary { background: #ff6b6b; color: white; }
        .btn-secondary { background: #6c757d; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-warning { background: #ffc107; color: black; }
        .btn-danger { background: #dc3545; color: white; }
        .btn-small { padding: 5px 10px; font-size: 12px; }
        .item {
            background: #f8f9fa;
            margin: 10px 0;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #ff6b6b;
        }
        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .item-title {
            font-weight: bold;
            font-size: 16px;
        }
        .required { color: red; }
        .no-items {
            text-align: center;
            color: #666;
            padding: 40px;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü•™ Sistema Pastrami</h1>
            <p>Gesti√≥n simple y funcional</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('clientes')">üë• Clientes</button>
            <button class="tab" onclick="showTab('productos')">üì¶ Productos</button>
            <button class="tab" onclick="showTab('pedidos')">üìã Pedidos</button>
            <button class="tab" onclick="showTab('pagos')">üí∞ Pagos</button>
        </div>

        <!-- CLIENTES -->
        <div id="clientes" class="tab-content active">
            <h2>üë• Gesti√≥n de Clientes</h2>
            
            <form id="cliente-form">
                <div class="form-row">
                    <div class="form-col">
                        <label>Nombre <span class="required">*</span>:</label>
                        <input type="text" id="cliente-nombre" required>
                    </div>
                    <div class="form-col">
                        <label>Apellido <span class="required">*</span>:</label>
                        <input type="text" id="cliente-apellido" required>
                    </div>
                    <div class="form-col">
                        <label>Tel√©fono <span class="required">*</span>:</label>
                        <input type="tel" id="cliente-telefono" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <label>Calle:</label>
                        <input type="text" id="cliente-calle">
                    </div>
                    <div class="form-col">
                        <label>N√∫mero:</label>
                        <input type="text" id="cliente-numero">
                    </div>
                    <div class="form-col">
                        <label>Piso/Departamento:</label>
                        <input type="text" id="cliente-piso">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <label>C√≥digo Postal:</label>
                        <input type="text" id="cliente-codigo-postal">
                    </div>
                    <div class="form-col">
                        <label>Localidad:</label>
                        <input type="text" id="cliente-localidad">
                    </div>
                    <div class="form-col">
                        <label>Email:</label>
                        <input type="email" id="cliente-email">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">üíæ Guardar Cliente</button>
                <button type="button" class="btn btn-secondary" onclick="limpiarCliente()">‚ùå Cancelar</button>
            </form>

            <div id="clientes-lista"></div>
        </div>

        <!-- PRODUCTOS -->
        <div id="productos" class="tab-content">
            <h2>üì¶ Gesti√≥n de Productos</h2>
            
            <form id="producto-form">
                <div class="form-row">
                    <div class="form-col">
                        <label>ID del Producto:</label>
                        <input type="text" id="producto-id" required>
                    </div>
                    <div class="form-col">
                        <label>Nombre:</label>
                        <input type="text" id="producto-nombre" required>
                    </div>
                    <div class="form-col">
                        <label>Precio:</label>
                        <input type="number" id="producto-precio" step="0.01" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <label>Stock:</label>
                        <input type="number" id="producto-stock" value="0">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">üíæ Guardar Producto</button>
                <button type="button" class="btn btn-secondary" onclick="limpiarProducto()">‚ùå Cancelar</button>
            </form>

            <div id="productos-lista"></div>
        </div>

        <!-- PEDIDOS -->
        <div id="pedidos" class="tab-content">
            <h2>üìã Gesti√≥n de Pedidos</h2>
            
            <form id="pedido-form">
                <div class="form-row">
                    <div class="form-col">
                        <label>Cliente <span class="required">*</span>:</label>
                        <select id="pedido-cliente" required>
                            <option value="">Seleccionar cliente...</option>
                        </select>
                    </div>
                    <div class="form-col">
                        <label>Fecha de Entrega <span class="required">*</span>:</label>
                        <input type="date" id="pedido-fecha" required>
                    </div>
                    <div class="form-col">
                        <label>Horario <span class="required">*</span>:</label>
                        <select id="pedido-horario" required>
                            <option value="">Seleccionar...</option>
                            <option value="Ma√±ana">Ma√±ana</option>
                            <option value="Tarde">Tarde</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <label>Producto:</label>
                        <select id="pedido-producto">
                            <option value="">Seleccionar producto...</option>
                        </select>
                    </div>
                    <div class="form-col">
                        <label>Cantidad:</label>
                        <input type="number" id="pedido-cantidad" min="1" value="1">
                    </div>
                    <div class="form-col">
                        <button type="button" class="btn btn-secondary" onclick="agregarProducto()">‚ûï Agregar</button>
                    </div>
                </div>

                <div id="productos-pedido"></div>

                <div class="form-row">
                    <div class="form-col">
                        <label>Costo de Env√≠o:</label>
                        <input type="number" id="pedido-envio" step="0.01" value="0">
                    </div>
                </div>

                <div style="background: #e9ecef; padding: 15px; border-radius: 5px; margin: 15px 0;">
                    <div><strong>Subtotal: $<span id="subtotal">0.00</span></strong></div>
                    <div><strong>Env√≠o: $<span id="envio-display">0.00</span></strong></div>
                    <div style="font-size: 18px;"><strong>TOTAL: $<span id="total">0.00</span></strong></div>
                </div>

                <button type="submit" class="btn btn-primary">üíæ Guardar Pedido</button>
                <button type="button" class="btn btn-secondary" onclick="limpiarPedido()">‚ùå Cancelar</button>
            </form>

            <div id="pedidos-lista"></div>
        </div>

        <!-- PAGOS -->
        <div id="pagos" class="tab-content">
            <h2>üí∞ Gesti√≥n de Pagos</h2>
            
            <form id="pago-form">
                <div class="form-row">
                    <div class="form-col">
                        <label>Pedido:</label>
                        <select id="pago-pedido" required>
                            <option value="">Seleccionar pedido...</option>
                        </select>
                    </div>
                    <div class="form-col">
                        <label>Monto:</label>
                        <input type="number" id="pago-monto" step="0.01" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <label>M√©todo:</label>
                        <select id="pago-metodo" required>
                            <option value="">Seleccionar...</option>
                            <option value="Mercado Pago">Mercado Pago</option>
                            <option value="Efectivo">Efectivo</option>
                            <option value="Transferencia">Transferencia</option>
                        </select>
                    </div>
                    <div class="form-col">
                        <label>Fecha:</label>
                        <input type="date" id="pago-fecha" required>
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">üí∞ Registrar Pago</button>
                <button type="button" class="btn btn-secondary" onclick="limpiarPago()">‚ùå Cancelar</button>
            </form>

            <div id="pagos-lista"></div>
        </div>
    </div>

    <script>
        let clientes = JSON.parse(localStorage.getItem('pastrami_clientes') || '[]');
        let productos = JSON.parse(localStorage.getItem('pastrami_productos') || '[]');
        let pedidos = JSON.parse(localStorage.getItem('pastrami_pedidos') || '[]');
        let pagos = JSON.parse(localStorage.getItem('pastrami_pagos') || '[]');
        let productosPedidoTemp = [];
        let contadorClientes = Math.max(0, ...clientes.map(c => c.id || 0)) + 1;

        document.addEventListener('DOMContentLoaded', function() {
            mostrarClientes();
            mostrarProductos();
            mostrarPedidos();
            mostrarPagos();
            actualizarSelects();
            document.getElementById('pago-fecha').value = new Date().toISOString().split('T')[0];
        });

        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // CLIENTES
        document.getElementById('cliente-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const cliente = {
                id: contadorClientes++,
                nombre: document.getElementById('cliente-nombre').value.trim(),
                apellido: document.getElementById('cliente-apellido').value.trim(),
                telefono: document.getElementById('cliente-telefono').value.trim(),
                calle: document.getElementById('cliente-calle').value.trim(),
                numero: document.getElementById('cliente-numero').value.trim(),
                piso: document.getElementById('cliente-piso').value.trim(),
                codigoPostal: document.getElementById('cliente-codigo-postal').value.trim(),
                localidad: document.getElementById('cliente-localidad').value.trim(),
                email: document.getElementById('cliente-email').value.trim()
            };
            
            if (!cliente.nombre || !cliente.apellido || !cliente.telefono) {
                alert('Nombre, Apellido y Tel√©fono son obligatorios');
                return;
            }
            
            clientes.push(cliente);
            localStorage.setItem('pastrami_clientes', JSON.stringify(clientes));
            mostrarClientes();
            actualizarSelects();
            limpiarCliente();
            alert('Cliente guardado exitosamente');
        });

        function mostrarClientes() {
            const lista = document.getElementById('clientes-lista');
            
            if (clientes.length === 0) {
                lista.innerHTML = '<div class="no-items">No hay clientes registrados</div>';
                return;
            }
            
            lista.innerHTML = clientes.map(cliente => {
                let direccion = '';
                if (cliente.calle) direccion += cliente.calle;
                if (cliente.numero) direccion += ' ' + cliente.numero;
                if (cliente.piso) direccion += ', ' + cliente.piso;
                if (cliente.localidad) direccion += ', ' + cliente.localidad;
                if (cliente.codigoPostal) direccion += ' (' + cliente.codigoPostal + ')';
                
                return `
                    <div class="item">
                        <div class="item-header">
                            <div class="item-title">ID: ${cliente.id} - ${cliente.nombre} ${cliente.apellido}</div>
                            <button class="btn btn-danger btn-small" onclick="eliminarCliente(${cliente.id})">üóëÔ∏è</button>
                        </div>
                        <div>Tel√©fono: ${cliente.telefono}</div>
                        ${cliente.email ? `<div>Email: ${cliente.email}</div>` : ''}
                        ${direccion ? `<div>Direcci√≥n: ${direccion}</div>` : ''}
                    </div>
                `;
            }).join('');
        }

        function eliminarCliente(id) {
            if (confirm('¬øEliminar cliente?')) {
                clientes = clientes.filter(c => c.id !== id);
                localStorage.setItem('pastrami_clientes', JSON.stringify(clientes));
                mostrarClientes();
                actualizarSelects();
            }
        }

        function limpiarCliente() {
            document.getElementById('cliente-form').reset();
        }

        // PRODUCTOS
        document.getElementById('producto-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const producto = {
                id: document.getElementById('producto-id').value.trim(),
                nombre: document.getElementById('producto-nombre').value.trim(),
                precio: parseFloat(document.getElementById('producto-precio').value),
                stock: parseInt(document.getElementById('producto-stock').value) || 0
            };
            
            if (!producto.id || !producto.nombre || !producto.precio) {
                alert('Todos los campos son obligatorios');
                return;
            }
            
            if (productos.find(p => p.id === producto.id)) {
                alert('Ya existe un producto con este ID');
                return;
            }
            
            productos.push(producto);
            localStorage.setItem('pastrami_productos', JSON.stringify(productos));
            mostrarProductos();
            actualizarSelects();
            limpiarProducto();
            alert('Producto guardado exitosamente');
        });

        function mostrarProductos() {
            const lista = document.getElementById('productos-lista');
            
            if (productos.length === 0) {
                lista.innerHTML = '<div class="no-items">No hay productos registrados</div>';
                return;
            }
            
            lista.innerHTML = productos.map(producto => `
                <div class="item">
                    <div class="item-header">
                        <div class="item-title">${producto.id} - ${producto.nombre}</div>
                        <button class="btn btn-danger btn-small" onclick="eliminarProducto('${producto.id}')">üóëÔ∏è</button>
                    </div>
                    <div>Precio: $${producto.precio.toFixed(2)} | Stock: ${producto.stock}</div>
                </div>
            `).join('');
        }

        function eliminarProducto(id) {
            if (confirm('¬øEliminar producto?')) {
                productos = productos.filter(p => p.id !== id);
                localStorage.setItem('pastrami_productos', JSON.stringify(productos));
                mostrarProductos();
                actualizarSelects();
            }
        }

        function limpiarProducto() {
            document.getElementById('producto-form').reset();
        }

        // PEDIDOS
        function agregarProducto() {
            const productoId = document.getElementById('pedido-producto').value;
            const cantidad = parseInt(document.getElementById('pedido-cantidad').value) || 1;
            
            if (!productoId) {
                alert('Selecciona un producto');
                return;
            }
            
            const producto = productos.find(p => p.id === productoId);
            if (!producto) return;
            
            const existe = productosPedidoTemp.find(p => p.id === productoId);
            if (existe) {
                existe.cantidad += cantidad;
            } else {
                productosPedidoTemp.push({
                    id: producto.id,
                    nombre: producto.nombre,
                    precio: producto.precio,
                    cantidad: cantidad
                });
            }
            
            mostrarProductosPedido();
            document.getElementById('pedido-producto').value = '';
            document.getElementById('pedido-cantidad').value = 1;
        }

        function mostrarProductosPedido() {
            const container = document.getElementById('productos-pedido');
            
            if (productosPedidoTemp.length === 0) {
                container.innerHTML = '<div style="color: #666; font-style: italic; padding: 10px;">No hay productos en el pedido</div>';
                calcularTotal();
                return;
            }
            
            container.innerHTML = productosPedidoTemp.map((item, index) => `
                <div class="item">
                    <div class="item-header">
                        <div>${item.cantidad}x ${item.nombre} - $${item.precio.toFixed(2)} c/u</div>
                        <div>
                            <span style="font-weight: bold;">$${(item.precio * item.cantidad).toFixed(2)}</span>
                            <button class="btn btn-danger btn-small" onclick="quitarProducto(${index})">‚ùå</button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            calcularTotal();
        }

        function quitarProducto(index) {
            productosPedidoTemp.splice(index, 1);
            mostrarProductosPedido();
        }

        function calcularTotal() {
            const subtotal = productosPedidoTemp.reduce((sum, item) => sum + (item.precio * item.cantidad), 0);
            const envio = parseFloat(document.getElementById('pedido-envio').value) || 0;
            const total = subtotal + envio;
            
            document.getElementById('subtotal').textContent = subtotal.toFixed(2);
            document.getElementById('envio-display').textContent = envio.toFixed(2);
            document.getElementById('total').textContent = total.toFixed(2);
        }

        document.getElementById('pedido-envio').addEventListener('change', calcularTotal);

        document.getElementById('pedido-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const clienteId = parseInt(document.getElementById('pedido-cliente').value);
            const fecha = document.getElementById('pedido-fecha').value;
            const horario = document.getElementById('pedido-horario').value;
            const envio = parseFloat(document.getElementById('pedido-envio').value) || 0;
            
            if (!clienteId || !fecha || !horario) {
                alert('Completa todos los campos obligatorios');
                return;
            }
            
            if (productosPedidoTemp.length === 0) {
                alert('Agrega al menos un producto');
                return;
            }
            
            const cliente = clientes.find(c => c.id === clienteId);
            const subtotal = productosPedidoTemp.reduce((sum, item) => sum + (item.precio * item.cantidad), 0);
            
            const pedido = {
                id: Date.now(),
                clienteId: clienteId,
                clienteNombre: cliente.nombre + ' ' + cliente.apellido,
                fecha: fecha,
                horario: horario,
                productos: productosPedidoTemp.slice(),
                subtotal: subtotal,
                envio: envio,
                total: subtotal + envio,
                estado: 'Pendiente'
            };
            
            pedidos.push(pedido);
            localStorage.setItem('pastrami_pedidos', JSON.stringify(pedidos));
            mostrarPedidos();
            actualizarSelects();
            limpiarPedido();
            alert('Pedido guardado exitosamente');
        });

        function mostrarPedidos() {
            const lista = document.getElementById('pedidos-lista');
            
            if (pedidos.length === 0) {
                lista.innerHTML = '<div class="no-items">No hay pedidos registrados</div>';
                return;
            }
            
            lista.innerHTML = pedidos.map(pedido => {
                const totalPagado = calcularTotalPagado(pedido.id);
                const saldo = pedido.total - totalPagado;
                if (saldo > 0) {
                    selectPedidos.innerHTML += `<option value="${pedido.id}">Pedido #${pedido.id} - ${pedido.clienteNombre} (Saldo: ${saldo.toFixed(2)})</option>`;
                }
            });
        }
    </script>
</body>
</html>
                const saldo = pedido.total - totalPagado;
                
                return `
                    <div class="item">
                        <div class="item-header">
                            <div class="item-title">Pedido #${pedido.id} - ${pedido.clienteNombre}</div>
                            <div>
                                ${pedido.estado === 'Pendiente' ? `<button class="btn btn-success btn-small" onclick="entregarPedido(${pedido.id})">‚úÖ Entregar</button>` : ''}
                                <button class="btn btn-danger btn-small" onclick="eliminarPedido(${pedido.id})">üóëÔ∏è</button>
                            </div>
                        </div>
                        <div>${pedido.fecha} - ${pedido.horario}</div>
                        <div>Total: $${pedido.total.toFixed(2)} | Pagado: $${totalPagado.toFixed(2)} | Saldo: $${saldo.toFixed(2)}</div>
                        <div>Estado: ${pedido.estado}</div>
                    </div>
                `;
            }).join('');
        }

        function entregarPedido(id) {
            if (confirm('¬øMarcar como entregado?')) {
                const pedido = pedidos.find(p => p.id === id);
                if (pedido) {
                    pedido.estado = 'Entregado';
                    localStorage.setItem('pastrami_pedidos', JSON.stringify(pedidos));
                    mostrarPedidos();
                }
            }
        }

        function eliminarPedido(id) {
            if (confirm('¬øEliminar pedido?')) {
                pedidos = pedidos.filter(p => p.id !== id);
                localStorage.setItem('pastrami_pedidos', JSON.stringify(pedidos));
                mostrarPedidos();
                actualizarSelects();
            }
        }

        function limpiarPedido() {
            document.getElementById('pedido-form').reset();
            productosPedidoTemp = [];
            mostrarProductosPedido();
        }

        // PAGOS
        document.getElementById('pago-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const pedidoId = parseInt(document.getElementById('pago-pedido').value);
            const monto = parseFloat(document.getElementById('pago-monto').value);
            const metodo = document.getElementById('pago-metodo').value;
            const fecha = document.getElementById('pago-fecha').value;
            
            if (!pedidoId || !monto || !metodo || !fecha) {
                alert('Completa todos los campos');
                return;
            }
            
            const pago = {
                id: Date.now(),
                pedidoId: pedidoId,
                monto: monto,
                metodo: metodo,
                fecha: fecha
            };
            
            pagos.push(pago);
            localStorage.setItem('pastrami_pagos', JSON.stringify(pagos));
            mostrarPagos();
            mostrarPedidos();
            actualizarSelects();
            limpiarPago();
            alert('Pago registrado exitosamente');
        });

        function mostrarPagos() {
            const lista = document.getElementById('pagos-lista');
            
            if (pagos.length === 0) {
                lista.innerHTML = '<div class="no-items">No hay pagos registrados</div>';
                return;
            }
            
            lista.innerHTML = pagos.map(pago => {
                const pedido = pedidos.find(p => p.id === pago.pedidoId);
                return `
                    <div class="item">
                        <div class="item-header">
                            <div class="item-title">$${pago.monto.toFixed(2)} - ${pago.metodo}</div>
                            <button class="btn btn-danger btn-small" onclick="eliminarPago(${pago.id})">üóëÔ∏è</button>
                        </div>
                        <div>Pedido: #${pago.pedidoId} ${pedido ? '- ' + pedido.clienteNombre : ''}</div>
                        <div>Fecha: ${pago.fecha}</div>
                    </div>
                `;
            }).join('');
        }

        function eliminarPago(id) {
            if (confirm('¬øEliminar pago?')) {
                pagos = pagos.filter(p => p.id !== id);
                localStorage.setItem('pastrami_pagos', JSON.stringify(pagos));
                mostrarPagos();
                mostrarPedidos();
            }
        }

        function limpiarPago() {
            document.getElementById('pago-form').reset();
            document.getElementById('pago-fecha').value = new Date().toISOString().split('T')[0];
        }

        // UTILIDADES
        function calcularTotalPagado(pedidoId) {
            return pagos.filter(p => p.pedidoId === pedidoId).reduce((sum, p) => sum + p.monto, 0);
        }

        function actualizarSelects() {
            // Actualizar select de clientes en pedidos
            const selectClientes = document.getElementById('pedido-cliente');
            selectClientes.innerHTML = '<option value="">Seleccionar cliente...</option>';
            clientes.forEach(cliente => {
                selectClientes.innerHTML += `<option value="${cliente.id}">${cliente.nombre} ${cliente.apellido}</option>`;
            });

            // Actualizar select de productos en pedidos
            const selectProductos = document.getElementById('pedido-producto');
            selectProductos.innerHTML = '<option value="">Seleccionar producto...</option>';
            productos.forEach(producto => {
                selectProductos.innerHTML += `<option value="${producto.id}">${producto.id} - ${producto.nombre} ($${producto.precio.toFixed(2)})</option>`;
            });

            // Actualizar select de pedidos en pagos
            const selectPedidos = document.getElementById('pago-pedido');
            selectPedidos.innerHTML = '<option value="">Seleccionar pedido...</option>';
            pedidos.forEach(pedido => {
                const totalPagado = calcularTotalPagado(pedido.id);
