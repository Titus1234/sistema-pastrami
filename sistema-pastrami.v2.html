<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü•™ Sistema Pastrami</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #ff7b7b 0%, #ff9966 100%);
            color: white;
            text-align: center;
            padding: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            border: none;
            background: none;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .tab:hover {
            background: #e9ecef;
        }

        .tab.active {
            background: white;
            border-bottom-color: #007bff;
            color: #007bff;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-col {
            flex: 1;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        .required {
            color: #dc3545;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #007bff;
        }

        .total-display {
            width: 100%;
            padding: 12px;
            border: 2px solid #28a745;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            background-color: #f8f9fa;
            color: #333;
            text-align: center;
        }

        .saldo-positivo {
            border-color: #dc3545;
            color: #dc3545;
        }

        .saldo-cero {
            border-color: #28a745;
            color: #28a745;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 10px;
        }

        .btn-primary {
            background: #007bff;
            color: white;
        }

        .btn-primary:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        .item-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .item-info h4 {
            color: #007bff;
            margin-bottom: 10px;
        }

        .item-info p {
            margin-bottom: 5px;
            color: #666;
        }

        .item-actions {
            display: flex;
            gap: 10px;
        }

        .btn-edit {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
        }

        .btn-edit:hover {
            background: #218838;
        }

        .btn-delete {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
        }

        .btn-delete:hover {
            background: #c82333;
        }

        h2 {
            color: #333;
            margin-bottom: 25px;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }

        h3 {
            color: #666;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .item-card {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
<div class="container">
        <div class="header">
            <h1>ü•™ Sistema Pastrami</h1>
            <p>Gesti√≥n completa de productos, clientes y pedidos</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('productos', this)">üì¶ Productos</button>
            <button class="tab" onclick="showTab('clientes', this)">üë• Clientes</button>
            <button class="tab" onclick="showTab('pedidos', this)">ü•™ Pedidos</button>
        </div>

        <div id="productos" class="tab-content active">
            <h2>üì¶ Gesti√≥n de Productos</h2>
            
            <form id="productos-form" onsubmit="guardarProducto(event)">
                <div class="form-row">
                    <div class="form-col">
                        <label for="producto-nombre">Nombre <span class="required">*</span>:</label>
                        <input type="text" id="producto-nombre" required>
                    </div>
                    <div class="form-col">
                        <label for="producto-precio">Precio <span class="required">*</span>:</label>
                        <input type="number" id="producto-precio" step="0.01" min="0" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <label for="producto-tipo">Tipo <span class="required">*</span>:</label>
                        <select id="producto-tipo" onchange="toggleComponentes()" required>
                            <option value="">Seleccionar...</option>
                            <option value="simple">Producto Simple</option>
                            <option value="compuesto">Producto Compuesto</option>
                        </select>
                    </div>
                    <div class="form-col">
                        <label for="producto-descripcion">Descripci√≥n:</label>
                        <input type="text" id="producto-descripcion">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <label for="producto-stock-inicial">Stock Inicial <span class="required">*</span>:</label>
                        <input type="number" id="producto-stock-inicial" min="0" required>
                    </div>
                    <div class="form-col">
                        <label for="producto-stock-minimo">Stock M√≠nimo <span class="required">*</span>:</label>
                        <input type="number" id="producto-stock-minimo" min="0" required>
                    </div>
                </div>

                <div id="componentes-section" style="display: none;">
                    <h3>Componentes del Producto</h3>
                    <div id="componentes-list">
                        <p style="color: #6c757d;">No hay componentes agregados</p>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <input type="text" id="componente-nombre" placeholder="Nombre del componente">
                        </div>
                        <div class="form-col">
                            <input type="number" id="componente-cantidad" placeholder="Cantidad" min="1">
                        </div>
                        <div class="form-col">
                            <button type="button" onclick="agregarComponente()">+ Agregar</button>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 20px;">
                    <button type="submit" class="btn btn-primary">üíæ Guardar</button>
                    <button type="button" class="btn btn-secondary" onclick="limpiarFormProducto()">‚ùå Limpiar</button>
                </div>
            </form>

            <div style="margin-top: 30px;">
                <h3>Lista de Productos</h3>
                <div id="productos-lista">
                    <p>No hay productos registrados</p>
                </div>
            </div>
        </div>

        <div id="clientes" class="tab-content">
            <h2>üë• Gesti√≥n de Clientes</h2>
            
            <form id="clientes-form" onsubmit="guardarCliente(event)">
                <div class="form-row">
                    <div class="form-col">
                        <label for="cliente-nombre">Nombre <span class="required">*</span>:</label>
                        <input type="text" id="cliente-nombre" required>
                    </div>
                    <div class="form-col">
                        <label for="cliente-apellido">Apellido <span class="required">*</span>:</label>
                        <input type="text" id="cliente-apellido" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <label for="cliente-telefono">Tel√©fono <span class="required">*</span>:</label>
                        <input type="tel" id="cliente-telefono" required>
                    </div>
                    <div class="form-col">
                        <label for="cliente-email">Email:</label>
                        <input type="email" id="cliente-email">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <label for="cliente-calle">Calle <span class="required">*</span>:</label>
                        <input type="text" id="cliente-calle" required>
                    </div>
                    <div class="form-col">
                        <label for="cliente-numero">N√∫mero <span class="required">*</span>:</label>
                        <input type="text" id="cliente-numero" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <label for="cliente-piso">Piso/Dpto:</label>
                        <input type="text" id="cliente-piso">
                    </div>
                    <div class="form-col">
                        <label for="cliente-postal">C√≥digo Postal <span class="required">*</span>:</label>
                        <input type="text" id="cliente-postal" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <label for="cliente-localidad">Localidad <span class="required">*</span>:</label>
                        <input type="text" id="cliente-localidad" required>
                    </div>
                </div>

                <div style="margin-top: 20px;">
                    <button type="submit" class="btn btn-primary">üíæ Guardar</button>
                    <button type="button" class="btn btn-secondary" onclick="limpiarFormCliente()">‚ùå Limpiar</button>
                </div>
            </form>

            <div style="margin-top: 30px;">
                <h3>Lista de Clientes</h3>
                <div id="clientes-lista">
                    <p>No hay clientes registrados</p>
                </div>
            </div>
        </div>
<div id="pedidos" class="tab-content">
            <h2>ü•™ Gesti√≥n de Pedidos</h2>
            
            <form id="pedidos-form" onsubmit="guardarPedido(event)">
                <div class="form-row">
                    <div class="form-col">
                        <label for="pedido-cliente">Cliente <span class="required">*</span>:</label>
                        <select id="pedido-cliente" required>
                            <option value="">Seleccionar cliente...</option>
                        </select>
                    </div>
                    <div class="form-col">
                        <label for="pedido-fecha">Fecha <span class="required">*</span>:</label>
                        <input type="date" id="pedido-fecha" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <label for="pedido-turno">Turno <span class="required">*</span>:</label>
                        <select id="pedido-turno" required>
                            <option value="">Seleccionar...</option>
                            <option value="ma√±ana">Ma√±ana</option>
                            <option value="tarde">Tarde</option>
                        </select>
                    </div>
                    <div class="form-col">
                        <label for="pedido-envio">Precio Env√≠o <span class="required">*</span>:</label>
                        <input type="number" id="pedido-envio" step="0.01" min="0" required onchange="calcularTotales()">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <label for="pedido-estado">Estado <span class="required">*</span>:</label>
                        <select id="pedido-estado" required>
                            <option value="">Seleccionar...</option>
                            <option value="pendiente">Pendiente</option>
                            <option value="preparando">Preparando</option>
                            <option value="listo">Listo</option>
                            <option value="entregado">Entregado</option>
                        </select>
                    </div>
                    <div class="form-col">
                        <label for="pedido-pago">Tipo Pago <span class="required">*</span>:</label>
                        <select id="pedido-pago" required>
                            <option value="">Seleccionar...</option>
                            <option value="total">Pago Total</option>
                            <option value="parcial">Pago Parcial</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <label for="pedido-modalidad">Modalidad Pago <span class="required">*</span>:</label>
                        <select id="pedido-modalidad" required>
                            <option value="">Seleccionar...</option>
                            <option value="efectivo">Efectivo</option>
                            <option value="transferencia">Transferencia Bancaria</option>
                            <option value="mercadopago">Mercado Pago</option>
                            <option value="otro">Otro</option>
                        </select>
                    </div>
                    <div class="form-col">
                        <label for="pedido-importe">Importe Pagado <span class="required">*</span>:</label>
                        <input type="number" id="pedido-importe" step="0.01" min="0" required onchange="calcularTotales()">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <label for="total-pedido">TOTAL DEL PEDIDO:</label>
                        <input type="text" id="total-pedido" class="total-display" readonly value="$0.00">
                    </div>
                    <div class="form-col">
                        <label for="total-abonado">TOTAL ABONADO:</label>
                        <input type="text" id="total-abonado" class="total-display" readonly value="$0.00">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <label for="saldo-pendiente">SALDO:</label>
                        <input type="text" id="saldo-pendiente" class="total-display saldo-cero" readonly value="$0.00">
                    </div>
                    <div class="form-col">
                        <label for="pedido-notas">Notas:</label>
                        <input type="text" id="pedido-notas">
                    </div>
                </div>

                <div style="margin-top: 20px;">
                    <h3>Productos del Pedido</h3>
                    <div id="productos-pedido">
                        <p style="color: #6c757d;">No hay productos agregados</p>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <select id="pedido-producto">
                                <option value="">Seleccionar producto...</option>
                            </select>
                        </div>
                        <div class="form-col">
                            <input type="number" id="pedido-cantidad" placeholder="Cantidad" min="1">
                        </div>
                        <div class="form-col">
                            <button type="button" onclick="agregarProductoPedido()">+ Agregar</button>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 20px;">
                    <button type="submit" class="btn btn-primary">üíæ Guardar</button>
                    <button type="button" class="btn btn-secondary" onclick="limpiarFormPedido()">‚ùå Limpiar</button>
                </div>
            </form>

            <div style="margin-top: 30px;">
                <h3>Lista de Pedidos</h3>
                <div id="pedidos-lista">
                    <p>No hay pedidos registrados</p>
                </div>
            </div>
        </div>
    </div>
<script>
        // Variables globales
        let productos = [];
        let clientes = [];
        let pedidos = [];
        let componentes = [];
        let productosPedido = [];
        let editandoProducto = null;
        let editandoCliente = null;
        let editandoPedido = null;

        // Funci√≥n para cambiar entre pesta√±as
        function showTab(tabName, element) {
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => tab.classList.remove('active'));
            
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            element.classList.add('active');
        }

        // Funci√≥n para calcular totales en tiempo real
        function calcularTotales() {
            const envio = parseFloat(document.getElementById('pedido-envio').value) || 0;
            const importe = parseFloat(document.getElementById('pedido-importe').value) || 0;
            
            // Calcular subtotal de productos
            let subtotalProductos = 0;
            productosPedido.forEach(producto => {
                subtotalProductos += producto.precio * producto.cantidad;
            });
            
            const totalPedido = subtotalProductos + envio;
            const saldo = totalPedido - importe;
            
            // Actualizar campos visuales
            document.getElementById('total-pedido').value = '$' + totalPedido.toFixed(2);
            document.getElementById('total-abonado').value = '$' + importe.toFixed(2);
            document.getElementById('saldo-pendiente').value = '$' + saldo.toFixed(2);
            
            // Cambiar colores seg√∫n el saldo
            const saldoField = document.getElementById('saldo-pendiente');
            if (saldo > 0.01) {
                saldoField.className = 'total-display saldo-positivo';
            } else {
                saldoField.className = 'total-display saldo-cero';
            }
        }

        // Funci√≥n para mostrar/ocultar secci√≥n de componentes
        function toggleComponentes() {
            const tipo = document.getElementById('producto-tipo').value;
            const section = document.getElementById('componentes-section');
            
            if (tipo === 'compuesto') {
                section.style.display = 'block';
            } else {
                section.style.display = 'none';
                componentes = [];
                actualizarListaComponentes();
            }
        }

        // Funci√≥n para agregar componente
        function agregarComponente() {
            const nombre = document.getElementById('componente-nombre').value.trim();
            const cantidad = parseInt(document.getElementById('componente-cantidad').value);
            
            if (!nombre || !cantidad || cantidad <= 0) {
                alert('Por favor, ingresa nombre y cantidad v√°lidos para el componente');
                return;
            }
            
            componentes.push({ nombre, cantidad });
            document.getElementById('componente-nombre').value = '';
            document.getElementById('componente-cantidad').value = '';
            actualizarListaComponentes();
        }

        // Funci√≥n para actualizar lista de componentes
        function actualizarListaComponentes() {
            const lista = document.getElementById('componentes-list');
            
            if (componentes.length === 0) {
                lista.innerHTML = '<p style="color: #6c757d;">No hay componentes agregados</p>';
                return;
            }
            
            let html = '';
            componentes.forEach((comp, index) => {
                html += `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 5px 0; border-bottom: 1px solid #eee;">
                        <span>${comp.nombre} (${comp.cantidad})</span>
                        <button type="button" onclick="eliminarComponente(${index})" style="background: #dc3545; color: white; border: none; padding: 2px 8px; border-radius: 3px; cursor: pointer;">√ó</button>
                    </div>
                `;
            });
            lista.innerHTML = html;
        }

        // Funci√≥n para eliminar componente
        function eliminarComponente(index) {
            componentes.splice(index, 1);
            actualizarListaComponentes();
        }

        // Funci√≥n para actualizar lista de productos en pedido
        function actualizarListaProductosPedido() {
            const lista = document.getElementById('productos-pedido');
            
            if (productosPedido.length === 0) {
                lista.innerHTML = '<p style="color: #6c757d;">No hay productos agregados</p>';
                calcularTotales();
                return;
            }
            
            let html = '';
            let total = 0;
            
            productosPedido.forEach((producto, index) => {
                const subtotal = producto.precio * producto.cantidad;
                total += subtotal;
                
                html += `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 5px 0; border-bottom: 1px solid #eee;">
                        <span>${producto.nombre} x${producto.cantidad} = $${subtotal.toFixed(2)}</span>
                        <button type="button" onclick="eliminarProductoPedido(${index})" style="background: #dc3545; color: white; border: none; padding: 2px 8px; border-radius: 3px; cursor: pointer;">√ó</button>
                    </div>
                `;
            });
            
            html += `<div style="margin-top: 10px; font-weight: bold; text-align: right;">Subtotal Productos: $${total.toFixed(2)}</div>`;
            lista.innerHTML = html;
            
            // Recalcular totales
            calcularTotales();
        }

        // Funci√≥n para eliminar producto del pedido
        function eliminarProductoPedido(index) {
            productosPedido.splice(index, 1);
            actualizarListaProductosPedido();
        }

        // Funci√≥n para agregar producto al pedido
        function agregarProductoPedido() {
            const productoId = document.getElementById('pedido-producto').value;
            const cantidad = parseInt(document.getElementById('pedido-cantidad').value);
            
            if (!productoId || !cantidad || cantidad <= 0) {
                alert('Por favor, selecciona un producto y una cantidad v√°lida');
                return;
            }
            
            const producto = productos.find(p => p.id == productoId);
            if (!producto) {
                alert('Producto no encontrado');
                return;
            }
            
            if (cantidad > producto.stockActual) {
                alert(`Stock insuficiente. Stock disponible: ${producto.stockActual}`);
                return;
            }
            
            const productoExistente = productosPedido.find(p => p.id == productoId);
            if (productoExistente) {
                productoExistente.cantidad += cantidad;
            } else {
                productosPedido.push({
                    id: producto.id,
                    nombre: producto.nombre,
                    precio: producto.precio,
                    cantidad: cantidad
                });
            }
            
            document.getElementById('pedido-producto').value = '';
            document.getElementById('pedido-cantidad').value = '';
            actualizarListaProductosPedido();
        }
// Funci√≥n para guardar producto
        function guardarProducto(event) {
            event.preventDefault();
            
            const nombre = document.getElementById('producto-nombre').value.trim();
            const precio = parseFloat(document.getElementById('producto-precio').value);
            const tipo = document.getElementById('producto-tipo').value;
            const descripcion = document.getElementById('producto-descripcion').value.trim();
            const stockInicial = parseInt(document.getElementById('producto-stock-inicial').value);
            const stockMinimo = parseInt(document.getElementById('producto-stock-minimo').value);
            
            if (!nombre || !precio || !tipo || stockInicial < 0 || stockMinimo < 0) {
                alert('Por favor, completa todos los campos obligatorios correctamente');
                return;
            }
            
            if (tipo === 'compuesto' && componentes.length === 0) {
                alert('Un producto compuesto debe tener al menos un componente');
                return;
            }
            
            const producto = {
                id: editandoProducto ? editandoProducto.id : Date.now(),
                nombre,
                precio,
                tipo,
                descripcion,
                stockInicial,
                stockActual: editandoProducto ? editandoProducto.stockActual : stockInicial,
                stockMinimo,
                componentes: [...componentes]
            };
            
            if (editandoProducto) {
                const index = productos.findIndex(p => p.id === editandoProducto.id);
                productos[index] = producto;
                alert('Producto actualizado correctamente');
            } else {
                productos.push(producto);
                alert('Producto guardado correctamente');
            }
            
            limpiarFormProducto();
            mostrarProductos();
            actualizarSelectProductos();
        }

        // Funci√≥n para mostrar productos
        function mostrarProductos() {
            const lista = document.getElementById('productos-lista');
            
            if (productos.length === 0) {
                lista.innerHTML = '<p>No hay productos registrados</p>';
                return;
            }
            
            let html = '';
            productos.forEach(producto => {
                const alertaStock = producto.stockActual <= producto.stockMinimo ? 'style="background-color: #ffe6e6;"' : '';
                const componentesHtml = producto.componentes.length > 0 ? 
                    `<br><small>Componentes: ${producto.componentes.map(c => c.nombre + ' (' + c.cantidad + ')').join(', ')}</small>` : '';
                
                html += `
                    <div class="item-card" ${alertaStock}>
                        <div class="item-info">
                            <h4>${producto.nombre}</h4>
                            <p><strong>Precio:</strong> $${producto.precio.toFixed(2)}</p>
                            <p><strong>Tipo:</strong> ${producto.tipo}</p>
                            ${producto.descripcion ? `<p><strong>Descripci√≥n:</strong> ${producto.descripcion}</p>` : ''}
                            <p><strong>Stock:</strong> ${producto.stockActual} / M√≠nimo: ${producto.stockMinimo}</p>
                            ${componentesHtml}
                            ${producto.stockActual <= producto.stockMinimo ? '<p style="color: red; font-weight: bold;">‚ö†Ô∏è Stock bajo</p>' : ''}
                        </div>
                        <div class="item-actions">
                            <button onclick="editarProducto(${producto.id})" class="btn-edit">‚úèÔ∏è</button>
                            <button onclick="eliminarProducto(${producto.id})" class="btn-delete">üóëÔ∏è</button>
                        </div>
                    </div>
                `;
            });
            
            lista.innerHTML = html;
        }

        // Funci√≥n para editar producto
        function editarProducto(id) {
            const producto = productos.find(p => p.id === id);
            if (!producto) return;
            
            editandoProducto = producto;
            
            document.getElementById('producto-nombre').value = producto.nombre;
            document.getElementById('producto-precio').value = producto.precio;
            document.getElementById('producto-tipo').value = producto.tipo;
            document.getElementById('producto-descripcion').value = producto.descripcion;
            document.getElementById('producto-stock-inicial').value = producto.stockInicial;
            document.getElementById('producto-stock-minimo').value = producto.stockMinimo;
            
            componentes = [...producto.componentes];
            toggleComponentes();
            actualizarListaComponentes();
        }

        // Funci√≥n para eliminar producto
        function eliminarProducto(id) {
            if (confirm('¬øEst√°s seguro de que quieres eliminar este producto?')) {
                productos = productos.filter(p => p.id !== id);
                mostrarProductos();
                actualizarSelectProductos();
                alert('Producto eliminado correctamente');
            }
        }

        // Funci√≥n para actualizar select productos
        function actualizarSelectProductos() {
            const select = document.getElementById('pedido-producto');
            select.innerHTML = '<option value="">Seleccionar producto...</option>';
            
            productos.forEach(producto => {
                select.innerHTML += `<option value="${producto.id}">${producto.nombre} - $${producto.precio.toFixed(2)}</option>`;
            });
        }

        // Funci√≥n para guardar cliente
        function guardarCliente(event) {
            event.preventDefault();
            
            const nombre = document.getElementById('cliente-nombre').value.trim();
            const apellido = document.getElementById('cliente-apellido').value.trim();
            const telefono = document.getElementById('cliente-telefono').value.trim();
            const email = document.getElementById('cliente-email').value.trim();
            const calle = document.getElementById('cliente-calle').value.trim();
            const numero = document.getElementById('cliente-numero').value.trim();
            const piso = document.getElementById('cliente-piso').value.trim();
            const postal = document.getElementById('cliente-postal').value.trim();
            const localidad = document.getElementById('cliente-localidad').value.trim();
            
            if (!nombre || !apellido || !telefono || !calle || !numero || !postal || !localidad) {
                alert('Por favor, completa todos los campos obligatorios');
                return;
            }
            
            const cliente = {
                id: editandoCliente ? editandoCliente.id : Date.now(),
                nombre,
                apellido,
                telefono,
                email,
                calle,
                numero,
                piso,
                postal,
                localidad
            };
            
            if (editandoCliente) {
                const index = clientes.findIndex(c => c.id === editandoCliente.id);
                clientes[index] = cliente;
                alert('Cliente actualizado correctamente');
            } else {
                clientes.push(cliente);
                alert('Cliente guardado correctamente');
            }
            
            limpiarFormCliente();
            mostrarClientes();
            actualizarSelectClientes();
        }

        // Funci√≥n para mostrar clientes
        function mostrarClientes() {
            const lista = document.getElementById('clientes-lista');
            
            if (clientes.length === 0) {
                lista.innerHTML = '<p>No hay clientes registrados</p>';
                return;
            }
            
            let html = '';
            clientes.forEach(cliente => {
                const direccionCompleta = `${cliente.calle} ${cliente.numero}${cliente.piso ? ', ' + cliente.piso : ''}, CP ${cliente.postal}, ${cliente.localidad}`;
                
                html += `
                    <div class="item-card">
                        <div class="item-info">
                            <h4>${cliente.nombre} ${cliente.apellido}</h4>
                            <p><strong>Tel√©fono:</strong> ${cliente.telefono}</p>
                            ${cliente.email ? `<p><strong>Email:</strong> ${cliente.email}</p>` : ''}
                            <p><strong>Direcci√≥n:</strong> ${direccionCompleta}</p>
                        </div>
                        <div class="item-actions">
                            <button onclick="editarCliente(${cliente.id})" class="btn-edit">‚úèÔ∏è</button>
                            <button onclick="eliminarCliente(${cliente.id})" class="btn-delete">üóëÔ∏è</button>
                        </div>
                    </div>
                `;
            });
            
            lista.innerHTML = html;
        }

        // Funci√≥n para editar cliente
        function editarCliente(id) {
            const cliente = clientes.find(c => c.id === id);
            if (!cliente) return;
            
            editandoCliente = cliente;
            
            document.getElementById('cliente-nombre').value = cliente.nombre;
            document.getElementById('cliente-apellido').value = cliente.apellido || '';
            document.getElementById('cliente-telefono').value = cliente.telefono;
            document.getElementById('cliente-email').value = cliente.email || '';
            document.getElementById('cliente-calle').value = cliente.calle || '';
            document.getElementById('cliente-numero').value = cliente.numero || '';
            document.getElementById('cliente-piso').value = cliente.piso || '';
            document.getElementById('cliente-postal').value = cliente.postal || '';
            document.getElementById('cliente-localidad').value = cliente.localidad || '';
        }

        // Funci√≥n para eliminar cliente
        function eliminarCliente(id) {
            if (confirm('¬øEst√°s seguro de que quieres eliminar este cliente?')) {
                clientes = clientes.filter(c => c.id !== id);
                mostrarClientes();
                actualizarSelectClientes();
                alert('Cliente eliminado correctamente');
            }
        }

        // Funci√≥n para actualizar select clientes
        function actualizarSelectClientes() {
            const select = document.getElementById('pedido-cliente');
            select.innerHTML = '<option value="">Seleccionar cliente...</option>';
            
            clientes.forEach(cliente => {
                select.innerHTML += `<option value="${cliente.id}">${cliente.nombre} ${cliente.apellido}</option>`;
            });
        }
// Funci√≥n para guardar pedido
        function guardarPedido(event) {
            event.preventDefault();
            
            const clienteId = document.getElementById('pedido-cliente').value;
            const fecha = document.getElementById('pedido-fecha').value;
            const turno = document.getElementById('pedido-turno').value;
            const envio = parseFloat(document.getElementById('pedido-envio').value);
            const estado = document.getElementById('pedido-estado').value;
            const pago = document.getElementById('pedido-pago').value;
            const modalidad = document.getElementById('pedido-modalidad').value;
            const importe = parseFloat(document.getElementById('pedido-importe').value);
            const notas = document.getElementById('pedido-notas').value.trim();
            
            if (!clienteId || !fecha || !turno || isNaN(envio) || !estado || !pago || !modalidad || isNaN(importe)) {
                alert('Por favor, completa todos los campos obligatorios');
                return;
            }
            
            if (productosPedido.length === 0) {
                alert('Agrega al menos un producto al pedido');
                return;
            }
            
            const cliente = clientes.find(c => c.id == clienteId);
            let subtotal = 0;
            
            // Calcular subtotal y actualizar stock
            productosPedido.forEach(prodPedido => {
                subtotal += prodPedido.precio * prodPedido.cantidad;
                
                if (!editandoPedido) {
                    const producto = productos.find(p => p.id == prodPedido.id);
                    if (producto) {
                        producto.stockActual -= prodPedido.cantidad;
                    }
                }
            });
            
            const totalFinal = subtotal + envio;
            const saldo = totalFinal - importe;
            
            // Validar importe seg√∫n tipo de pago
            if (pago === 'total' && importe < totalFinal) {
                alert(`Para pago total, el importe debe ser $${totalFinal.toFixed(2)}`);
                return;
            }
            
            if (importe > totalFinal) {
                alert(`El importe no puede ser mayor al total ($${totalFinal.toFixed(2)})`);
                return;
            }
            
            const pedido = {
                id: editandoPedido ? editandoPedido.id : Date.now(),
                clienteId: parseInt(clienteId),
                clienteNombre: cliente.nombre + ' ' + cliente.apellido,
                fecha,
                turno,
                envio,
                estado,
                pago,
                modalidad,
                importe,
                notas,
                productos: [...productosPedido],
                subtotal: subtotal,
                total: totalFinal,
                saldo: saldo
            };
            
            if (editandoPedido) {
                const index = pedidos.findIndex(p => p.id === editandoPedido.id);
                pedidos[index] = pedido;
                alert('Pedido actualizado correctamente');
            } else {
                pedidos.push(pedido);
                alert('Pedido guardado correctamente');
            }
            
            limpiarFormPedido();
            mostrarPedidos();
            mostrarProductos();
        }

        // Funci√≥n para mostrar pedidos
        function mostrarPedidos() {
            const lista = document.getElementById('pedidos-lista');
            
            if (pedidos.length === 0) {
                lista.innerHTML = '<p>No hay pedidos registrados</p>';
                return;
            }
            
            let html = '';
            pedidos.forEach(pedido => {
                const productosHtml = pedido.productos.map(p => 
                    `${p.nombre} x${p.cantidad}`
                ).join(', ');
                
                const estadoColor = {
                    'pendiente': '#ffc107',
                    'preparando': '#17a2b8',
                    'listo': '#28a745',
                    'entregado': '#6c757d'
                };
                
                const modalidadTexto = {
                    'efectivo': 'Efectivo',
                    'transferencia': 'Transferencia Bancaria',
                    'mercadopago': 'Mercado Pago',
                    'otro': 'Otro'
                };
                
                const subtotalPedido = pedido.subtotal || 0;
                const importePedido = pedido.importe || 0;
                const saldoPedido = pedido.saldo || 0;
                const estadoPago = saldoPedido > 0.01 ? '‚ö†Ô∏è PENDIENTE' : '‚úÖ PAGADO';
                const colorSaldo = saldoPedido > 0.01 ? 'red' : 'green';
                const modalidadMostrar = pedido.modalidad ? modalidadTexto[pedido.modalidad] || pedido.modalidad : 'No especificada';
                
                html += `
                    <div class="item-card">
                        <div class="item-info">
                            <h4>Pedido #${pedido.id}</h4>
                            <p><strong>Cliente:</strong> ${pedido.clienteNombre}</p>
                            <p><strong>Fecha:</strong> ${pedido.fecha}</p>
                            <p><strong>Turno:</strong> ${pedido.turno}</p>
                            <p><strong>Estado:</strong> <span style="color: ${estadoColor[pedido.estado]}; font-weight: bold;">${pedido.estado.toUpperCase()}</span></p>
                            <p><strong>Productos:</strong> ${productosHtml}</p>
                            <p><strong>Subtotal:</strong> $${subtotalPedido.toFixed(2)}</p>
                            <p><strong>Env√≠o:</strong> $${(pedido.envio || 0).toFixed(2)}</p>
                            <p><strong>Total:</strong> $${pedido.total.toFixed(2)}</p>
                            <p><strong>Modalidad:</strong> ${modalidadMostrar}</p>
                            <p><strong>Pagado:</strong> $${importePedido.toFixed(2)}</p>
                            <p><strong>Saldo:</strong> <span style="color: ${colorSaldo}; font-weight: bold;">$${saldoPedido.toFixed(2)}</span></p>
                            <p><strong>Estado Pago:</strong> <span style="color: ${colorSaldo}; font-weight: bold;">${estadoPago}</span></p>
                            ${pedido.notas ? `<p><strong>Notas:</strong> ${pedido.notas}</p>` : ''}
                        </div>
                        <div class="item-actions">
                            <button onclick="editarPedido(${pedido.id})" class="btn-edit">‚úèÔ∏è</button>
                            <button onclick="eliminarPedido(${pedido.id})" class="btn-delete">üóëÔ∏è</button>
                        </div>
                    </div>
                `;
            });
            
            lista.innerHTML = html;
        }

        // Funci√≥n para editar pedido
        function editarPedido(id) {
            const pedido = pedidos.find(p => p.id === id);
            if (!pedido) return;
            
            editandoPedido = pedido;
            
            document.getElementById('pedido-cliente').value = pedido.clienteId;
            document.getElementById('pedido-fecha').value = pedido.fecha;
            document.getElementById('pedido-turno').value = pedido.turno;
            document.getElementById('pedido-envio').value = pedido.envio;
            document.getElementById('pedido-estado').value = pedido.estado;
            document.getElementById('pedido-pago').value = pedido.pago;
            document.getElementById('pedido-modalidad').value = pedido.modalidad || '';
            document.getElementById('pedido-importe').value = pedido.importe || '';
            document.getElementById('pedido-notas').value = pedido.notas || '';
            
            productosPedido = [...pedido.productos];
            actualizarListaProductosPedido();
        }

        // Funci√≥n para eliminar pedido
        function eliminarPedido(id) {
            if (confirm('¬øEst√°s seguro de que quieres eliminar este pedido?')) {
                pedidos = pedidos.filter(p => p.id !== id);
                mostrarPedidos();
                alert('Pedido eliminado correctamente');
            }
        }

        // Funciones para limpiar formularios
        function limpiarFormProducto() {
            document.getElementById('productos-form').reset();
            componentes = [];
            actualizarListaComponentes();
            document.getElementById('componentes-section').style.display = 'none';
            editandoProducto = null;
        }

        function limpiarFormCliente() {
            document.getElementById('clientes-form').reset();
            editandoCliente = null;
        }

        function limpiarFormPedido() {
            document.getElementById('pedidos-form').reset();
            productosPedido = [];
            actualizarListaProductosPedido();
            editandoPedido = null;
            // Limpiar campos de totales
            document.getElementById('total-pedido').value = '$0.00';
            document.getElementById('total-abonado').value = '$0.00';
            document.getElementById('saldo-pendiente').value = '$0.00';
            document.getElementById('saldo-pendiente').className = 'total-display saldo-cero';
        }

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('pedido-fecha').value = today;
            
            mostrarProductos();
            mostrarClientes();
            mostrarPedidos();
        });
    </script>
</body>
</html>
